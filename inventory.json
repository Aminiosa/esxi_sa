{
  "1": {
    "Alert": "NULL",
    "Command": "uname -a",
    "Condition": "NULL",
    "Instruction": "\nglobal var, version, sName, jReport\nvar = var.split(\" \")\nsName = var[1]\njReport[sName] = {}\nversion = var[2]\nvar=var[1]",
    "Msg": "Getting name of server",
    "Name": "Host Name",
    "Parent": "NULL",
    "Ver": "0",
    "VerM": "99",
    "type": "ssh1"
  },
  "2": {
    "Alert": "NULL",
    "Command": "uname -a",
    "Instruction": "\nglobal var\nvar = var.split(\" \")\nvar=var[2]",
    "Condition": "NULL",
    "Msg": "Getting version of server",
    "Name": "Version",
    "Parent": "NULL",
    "Ver": "0",
    "VerM": "99",
    "type": "ssh"
  },
  "3": {
    "Alert": "NULL",
    "Command": "cat /etc/passwd | sed 's/\\:[^:]*\\:[^:]*\\:[^:]*\\:/\\:/' | sed  's/\\:\\/.*//'",
    "Instruction": "\nglobal var\nvar = var.split('\\n')\nvar.remove('')\ntemp = {}\nfor item in var:\n    item = item.split(':')\n    temp[item[0]]=item[1]\nvar = temp",
    "Condition": "NULL",
    "Msg": "getting System users and def.groups",
    "Name": "System Users : DefaultGroup",
    "Parent": "NULL",
    "Ver": "6.0",
    "VerM": "99",
    "type": "ssh"
  },
  "4": {
    "Alert": "NULL",
    "Command": "esxcli system account list | sed 1,2d | sed 's/[ ]\\+/\\:/'",
    "Instruction": "\nglobal var\nvar = var.split('\\n')\nvar.remove('')\ntemp = {}\nfor item in var:\n    item = item.split(':')\n    temp[item[0]]=item[1]\nvar = temp",
    "Condition": "NULL",
    "Msg": "getting ESXi users and note",
    "Name": "ESXi User : Description",
    "Parent": "NULL",
    "Ver": "6.0",
    "VerM": "99",
    "type": "ssh"
  },
  "5": {
    "Alert": "NULL",
    "Command": " esxcli system permission list | sed 1,2d | sed 's/[ ]\\{2,\\}\\+/\\:/g'",
    "Instruction": "\nglobal var\nvar = var.split('\\n')\nvar.remove('')\ntemp = {}\nfor item in var:\n    item = item.split(':')\n    if item[1] == 'false':\n     temp[item[0]]=item[2]\nvar = temp",
    "Condition": "NULL",
    "Msg": "getting ESXi users and note",
    "Name": "ESXi User : Role",
    "Parent": "NULL",
    "Ver": "6.0",
    "VerM": "99",
    "type": "ssh"
  },
  "6": {
    "Alert": "NULL",
    "Command": "esxcli hardware clock get | sed 's/[TZ]/ /g'",
    "Instruction": "\nglobal var\nvar=var[0:-1]",
    "Condition": "NULL",
    "Msg": "Getting system time",
    "Name": "System time",
    "Parent": "NULL",
    "Ver": "6.0",
    "VerM": "99",
    "type": "ssh"
  },
  "7": {
    "Alert": "NULL",
    "Command": "esxcli network ip interface list | sed 1d",
    "Instruction": "\nglobal var\nvar = var.split('\\n')\nvar.remove('')\ntemp = {}\nfor item in var:\n    item = item.split(':')\n    temp[item[0]]=item[1]\nvar = temp",
    "Condition": "NULL",
    "Msg": "Getting ip interface list",
    "Name": "IP Interface",
    "Parent": "NULL",
    "Ver": "0",
    "VerM": "99",
    "type": "ssh"
  },
  "8": {
    "Alert": "NULL",
    "Command": "chkconfig -l | sed 's/ \\+/ /'",
    "Instruction": "\nglobal var\nvar = var.split('\\n')\nvar.remove('')\ntemp = {}\nfor item in var:\n    item = item.split(' ')\n    temp[item[0]]=item[1]\nvar = temp",
    "Condition": "NULL",
    "Msg": "Looking for deamons",
    "Name": "Deamons' status",
    "Parent": "NULL",
    "Ver": "0",
    "VerM": "99",
    "type": "ssh"
  },
  "9": {
    "Alert": "NULL", 
    "Command": "esxcli storage vmfs extent list | sed 2d | sed 's/ \\{2,\\}/:/g'",
    "Instruction": "\nglobal var\nvar = var.split('\\n')\nvar.remove('')\nvar = [i.split(':') for i in var]\ntemp = {}\nfor item in var[1:]:\n temp[item[0]]={}\n for i in range(5):\n  temp[item[0]][var[0][i]] = item[i]\nvar = temp",
    "Condition": "NULL",
    "Msg": "VMFS",
    "Name": "VMFS",
    "Parent": "NULL",
    "Ver": "0",
    "VerM": "99",
    "type": "ssh"
  },
  "10": {
    "Alert": "NULL",
    "Command": "esxcli network ip dns server list | sed 's/\\:/''/' | sed 's/\\,/''/'",
    "Instruction": "\nglobal var\nvar=var[3:]\ntemp={}\nvar = var.split(' ')\ntemp = []\nfor item in var[1:]:\n    temp.append(item)\nvar = temp\nvar[-1]=var[-1][:-1]",
    "Condition": "NULL",
    "Msg": "DNS list",
    "Name": "DNS list",
    "Parent": "NULL",
    "Ver": "0",
    "VerM": "99",
    "type": "ssh"
  },
  "11": {
    "Alert": "NULL",
    "Command": "vim-cmd vmsvc/getallvms | sed 's/ \\{2,\\}/:/g' | sed 's/[ ]\\+/\\ /'",
    "Instruction": "\nglobal var\nvar = var.split('\\n')\nvar.remove('')\nvar = [i.split(':') for i in var]\ntemp = {}\nfor item in var[1:]:\n temp[item[0]]={}\n for i in range(6):\n  temp[item[0]][var[0][i]] = item[i]\nvar = temp",
    "Condition": "NULL",
    "Msg": "Getting all VMs names",
    "Name": "All VMs Information",
    "Parent": "NULL",
    "Ver": "0",
    "VerM": "99",
    "type": "ssh"
  },
  "12": {
    "Alert": "NULL",
    "Command": "lspci",
    "Instruction": "\nglobal var\nvar=var.split('\\n')\ntemp={}\nvar.remove('')\nfor item in var:\n   item=item.split(' ',1)\n   temp[item[0]]=item[1]\nvar=temp\n",
    "Condition": "NULL",
    "Msg": "Collecting PCIs",
    "Name": "PCI",
    "Parent": "NULL",
    "Ver": "5",
    "VerM": "99",
    "type": "ssh"
  },
  "13": {
    "Alert": "NULL",
    "Command": "cat /etc/hosts|sed '1d'| sed '1d'",
    "Instruction": "\nglobal var\nvar=var.split('\\n')\ntemp={}\nfor item in var:\n   item=item.split('\\t')\n   if ('') in item:      item.remove('')\n   if item==[]:\n      continue\n   temp[item[0]]=item[1]\nvar=temp",
    "Condition": "NULL",
    "Msg": "Collecting hosts",
    "Name": "Hosts",
    "Parent": "NULL",
    "Ver": "5",
    "VerM": "99",
    "type": "ssh"
  },
  "14": {
    "Alert": "NULL",
    "Instruction": "\nglobal var\nvar = var.split('\\n')\nvar.remove('')\nvar = [i.split(':') for i in var]\ntemp = {}\nfor item in var[1:]:\n temp[item[0]]={}\n for i in range(6):\n  temp[item[0]][var[0][i]] = item[i]\nvar = temp",
    "Command": "cat /etc/vmware/*.conf | grep -o 'ipv.*' | sed '1d;$d' | sed 's/\\=//' | sed 's/\\ //' | sed 's/\"//g'",
    "Instruction": "\nglobal var\nvar = var.split('\\n')\nif ('') in var:   var.remove('')\ntemp = {}\nfor item in var:\n   item=item.split(' ',1)\n   temp[item[0]]=item[1]\nvar = temp",
    "Condition": "NULL",
    "Msg": "Collecting network information",
    "Name": "Network configuration",
    "Parent": "NULL",
    "Ver": "5",
    "VerM": "99",
    "type": "ssh"
  },
  "15": {
    "Alert": "NULL",
    "Command": "esxcli hardware pci list",
    "Instruction": "\nglobal var\nvar=var.split('\\n\\n')\ntemp={}\nfor item in var:\n   item=item.split('\\n')\n   if ('') in item:      item.remove('')\n   key1=item.pop(0)\n   temp2={}\n   for item2 in item:\n      item2=item2.split(': ')\n      temp2[item2[0].lstrip()]=item2[1].lstrip()\n   temp[key1]=temp2\nvar=temp",
    "Condition": "NULL",
    "Msg": "Collecting PCI information",
    "Name": "PCI information",
    "Parent": "NULL",
    "Ver": "5",
    "VerM": "99",
    "type": "ssh"
  },
  "16": {
    "Alert": "NULL",
    "Command": "esxcfg-vswitch -l |sed 's/ \\{2,\\}/:/g' | grep Switch",
    "Instruction": "\nglobal var\nvar = var.split('\\n')\ndel var[-1]\nvar1=[]\nvar1.append(var[1])\nfor i in range (1,len(var)):\n   if ('Ports') not in var[i]: var1.append(var[i])\nvar=var1\nvar = [i.split(':') for i in var]\ntemp = {}\nfor item in var[1:]:\n temp[item[0]]={}\n for i in range(6):\n  temp[item[0]][var[0][i]] = item[i]\nvar = temp",
    "Condition": "NULL",
    "Msg": "Getting vSwitches parameters ",
    "Name": "vSwitches",
    "Parent": "NULL",
    "Ver": "5",
    "VerM": "99",
    "type": "ssh"
  },
  "17": {
    "id": "0",
    "Alert": "Not Secure level of image profile. Minimal level - Partner supported. To Fix:\\n Foreach ($VMHost in Get-VMHost ) {\\n$ESXCli = Get-EsxCli -VMHost $VMHost\\n$ESXCli.software.acceptance.Set(\"PartnerSupported\")\\n}",
    "Instruction": "var = ''\nglobal pshData\npshData = list(filter(None, pshData.split(\"\\n\")))\nfor iter in pshData[1:]:\n iter = iter.split(':')\n var = iter[1].lstrip()\npshData = var",
    "Command": [
      "Foreach ($VMHost in Get-VMHost ) {",
      "$ESXCli = Get-EsxCli -VMHost $VMHost",
      "$VMHost | Select Name, @{N=\"AcceptanceLevel\";E={$ESXCli.software.acceptance.get()}}",
      "}"
    ],
    "Condition": "if pshData != \"PartnerSupported\":\n alerts.append('----------->>>\\nCommunity Supported VIBs are not supported and do not have a digital signature. To\\nprotect the security and integrity of your ESXi hosts do not allow unsigned\\n(CommunitySupported) VIBs to be installed on your hosts.\\nRecommendations:\\nForeach ($VMHost in Get-VMHost ) {\\n$ESXCli = Get-EsxCli -VMHost $VMHost\\n$ESXCli.software.acceptance.Set(\"PartnerSupported\")\\n}\\n    ')",
    "Msg": "",
    "Name": "Acceptance Level",
    "Parent": "NULL",
    "Ver": "5",
    "VerM": "99",
    "type": "psh"
  },
  "18": {
    "id": "1",
    "Alert": "Not Secure level of image profile. Minimal level - Partner supported. To Fix:\\n Foreach ($VMHost in Get-VMHost ) {\\n$ESXCli = Get-EsxCli -VMHost $VMHost\\n$ESXCli.software.acceptance.Set(\"PartnerSupported\")\\n}",
    "Instruction": "NULL",
    "Command": [
      "Foreach ($VMHost in Get-VMHost ) {",
      "$ESXCli = Get-EsxCli -VMHost $VMHost",
      "$ESXCli.system.module.list() | Foreach {",
      "$ESXCli.system.module.get($_.Name) | Select @{N=\"VMHost\";E={$VMHost}}, Module,",
      "License, Modulefile, Version, SignedStatus, SignatureDigest, SignatureFingerPrint",
      "}",
      "}"
    ],
    "Condition": "NULL",
    "Msg": "",
    "Name": "vSwitches",
    "Parent": "NULL",
    "Ver": "5",
    "VerM": "99",
    "type": "psh"
  }
}